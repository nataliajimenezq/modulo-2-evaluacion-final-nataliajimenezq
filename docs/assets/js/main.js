"use strict";const elementUl=document.querySelector("#list"),elementForm=document.querySelector("#search-form"),buttonSearch=document.querySelector("#search-button"),searchInput=document.querySelector("#search-input"),favouriteSeries=document.querySelector(".favourite__series");let favouriteSeriesArray=[];const urlBase="http://api.tvmaze.com/search/shows?q=",imgDefault="https://via.placeholder.com/210x295/ffffff/666666/?text=TV",connectToAPI=()=>{fetch(urlBase+`${searchInput.value}`).then(e=>e.json()).then(e=>displaySeries(e)).catch(e=>console.log(e))};function loadFavouriteHandler(){const e=localStorage.getItem("favSeries");null!==e&&(favouriteSeriesArray=JSON.parse(e)),paintFavourites(favouriteSeriesArray)}function setLocalStorage(){localStorage.setItem("favSeries",JSON.stringify(favouriteSeriesArray))}function searchSeriesHandler(){connectToAPI(urlBase.toLowerCase(),displaySeries)}function enterKeyHandle(e){e.preventDefault(),searchSeriesHandler()}const displaySeries=e=>{for(const t of e){const e=t.show.name,r=t.show.image,a=document.createElement("li"),i=document.createElement("img"),s=document.createElement("span"),n=document.createTextNode(e);a.classList.add("serie__item"),i.classList.add("serie__img"),s.classList.add("serie__tittle"),s.appendChild(n),a.appendChild(i),a.appendChild(s),elementUl.appendChild(a),a.addEventListener("click",addFavourite),i.src=null===r?imgDefault:r.medium}};function addFavourite(e){let t=e.currentTarget;t.classList.toggle("selected");const r=t.querySelector(".serie__img"),a=t.querySelector(".serie__tittle"),i={name:a.innerHTML,image:r.src};if(t.classList.contains("selected"))favouriteSeriesArray.push(i),paintFavourites(),setLocalStorage();else for(let e=0;e<favouriteSeriesArray.length;e++)favouriteSeriesArray[e].name===a.innerHTML&&favouriteSeriesArray.splice(e,1);setLocalStorage()}function deleteFromFav(e){e.currentTarget.closest("li").classList.add("hidden")}function paintFavourites(){favouriteSeries.innerHTML="";for(let e of favouriteSeriesArray){const t=e.image,r=e.name,a=document.createElement("li"),i=document.createElement("span"),s=document.createElement("img"),n=document.createElement("div"),o=document.createTextNode(r);i.appendChild(o),a.appendChild(s),a.appendChild(i),a.appendChild(n),favouriteSeries.appendChild(a),s.src=t,a.classList.add("favourite__item"),s.classList.add("favourite__item-img"),n.classList.add("favourite__item-del"),n.addEventListener("click",deleteFromFav)}}buttonSearch.addEventListener("click",searchSeriesHandler),elementForm.addEventListener("submit",enterKeyHandle),window.addEventListener("load",loadFavouriteHandler);